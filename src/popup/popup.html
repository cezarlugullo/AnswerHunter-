<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AnswerHunter</title>
  <link rel="stylesheet" href="popup.css">
</head>

<body>
  <!-- ===== WELCOME OVERLAY ===== -->
  <div id="welcome-overlay" class="welcome-overlay hidden" role="dialog" aria-modal="true">
    <div class="welcome-card">
      <div class="welcome-illustration">
        <div class="welcome-orbit">
          <div class="orbit-ring"></div>
          <div class="orbit-dot dot-1"></div>
          <div class="orbit-dot dot-2"></div>
          <div class="orbit-dot dot-3"></div>
          <span class="material-symbols-rounded welcome-center-icon">rocket_launch</span>
        </div>
      </div>
      <h2 data-i18n="setup.welcome.title">Welcome to AnswerHunter</h2>
      <p data-i18n="setup.welcome.description">Before you start, set up your API keys. This takes less than 2 minutes.</p>
      <div class="welcome-features">
        <div class="welcome-feature">
          <span class="material-symbols-rounded">bolt</span>
          <span data-i18n="setup.welcome.feature1">AI-powered answers</span>
        </div>
        <div class="welcome-feature">
          <span class="material-symbols-rounded">search</span>
          <span data-i18n="setup.welcome.feature2">Source-backed results</span>
        </div>
        <div class="welcome-feature">
          <span class="material-symbols-rounded">lock</span>
          <span data-i18n="setup.welcome.feature3">100% private keys</span>
        </div>
      </div>
      <button id="welcomeStartBtn" class="btn-search welcome-start-btn">
        <span class="material-symbols-rounded">rocket_launch</span>
        <span data-i18n="setup.welcome.start">Start setup</span>
      </button>
      <p class="welcome-time-hint">
        <span class="material-symbols-rounded" style="font-size:14px;">timer</span>
        <span data-i18n="setup.welcome.timeHint">~2 min setup, free APIs</span>
      </p>
    </div>
  </div>

  <!-- ===== TOAST CONTAINER ===== -->
  <div id="toast-container" class="toast-container" aria-live="polite"></div>

  <!-- ===== MAIN CONTAINER ===== -->
  <div class="container">
    <header>
      <h1>
        <span class="material-symbols-rounded" style="font-size:28px;color:#FF6B00;">track_changes</span>
        <span data-i18n="app.title">AnswerHunter</span>
      </h1>
      <p class="subtitle" data-i18n="app.subtitle">Educational answer hunter</p>
      <div class="header-actions">
        <label class="language-select-wrap" for="languageSelect">
          <span class="material-symbols-rounded">translate</span>
          <select id="languageSelect" class="language-select" data-i18n-title="app.language">
            <option value="en" data-i18n="lang.english">English</option>
            <option value="pt-BR" data-i18n="lang.portuguese">Portuguese (Brazil)</option>
          </select>
        </label>
        <button id="settingsBtn" class="settings-btn" data-i18n-title="app.settings">
          <span class="material-symbols-rounded">settings</span>
        </button>
      </div>
    </header>

    <!-- ===== SETUP PANEL (compact) ===== -->
    <div id="setup-panel" class="setup-panel hidden">
      <div class="setup-header">
        <h3><span class="material-symbols-rounded">tune</span> <span data-i18n="setup.title">API Setup</span></h3>
        <button id="closeSetupBtn" class="action-btn" data-i18n-title="setup.close">
          <span class="material-symbols-rounded">close</span>
        </button>
      </div>

      <div class="setup-progress-bar">
        <div class="setup-progress-fill" id="setupProgressFill" style="width:33%"></div>
      </div>

      <div class="setup-stepper">
        <div class="stepper-step active" data-step="1">
          <div class="stepper-circle">
            <span class="stepper-number">1</span>
            <span class="material-symbols-rounded stepper-check">check</span>
          </div>
          <span class="stepper-label" data-i18n="provider.groq">Groq</span>
        </div>
        <div class="stepper-line"><div class="stepper-line-fill"></div></div>
        <div class="stepper-step" data-step="2">
          <div class="stepper-circle">
            <span class="stepper-number">2</span>
            <span class="material-symbols-rounded stepper-check">check</span>
          </div>
          <span class="stepper-label" data-i18n="provider.serper">Serper</span>
        </div>
        <div class="stepper-line"><div class="stepper-line-fill"></div></div>
        <div class="stepper-step" data-step="3">
          <div class="stepper-circle">
            <span class="stepper-number">3</span>
            <span class="material-symbols-rounded stepper-check">check</span>
          </div>
          <span class="stepper-label" data-i18n="provider.gemini">Gemini</span>
        </div>
      </div>

      <!-- ===== Step 1: Groq ===== -->
      <div class="setup-step-panel" data-step="1">
        <div class="step-header-row">
          <div class="step-icon-box groq-graphic">
            <span class="material-symbols-rounded">psychology</span>
          </div>
          <div class="step-header-text">
            <h4 data-i18n="setup.groq.title">Groq API key</h4>
            <p data-i18n="setup.groq.descriptionFull">Groq provides the AI that analyzes questions. Free and takes 30 seconds.</p>
          </div>
        </div>

        <div class="step-how-to">
          <p class="step-how-to-label" data-i18n="setup.howTo">How to get your key:</p>
          <ol class="step-instructions-list">
            <li data-i18n="setup.instructions.groq.1">Open console.groq.com/keys</li>
            <li data-i18n="setup.instructions.groq.2">Create a free account (Google or GitHub)</li>
            <li data-i18n="setup.instructions.groq.3">Click "Create API Key" and copy the key</li>
          </ol>
        </div>

        <a class="btn-get-key" href="https://console.groq.com/keys" target="_blank" rel="noopener">
          <span class="material-symbols-rounded">open_in_new</span>
          <span data-i18n="setup.openGroqSite">Open Groq Console</span>
          <span class="material-symbols-rounded btn-get-key-arrow">arrow_forward</span>
        </a>

        <div class="input-wrapper">
          <input id="input-groq" type="password" class="setup-input" autocomplete="off"
            data-i18n-placeholder="setup.placeholder.groq">
          <button class="visibility-toggle" data-target="input-groq" data-i18n-title="setup.toggleVisibility">
            <span class="material-symbols-rounded">visibility</span>
          </button>
        </div>
        <div class="step-input-actions">
          <button class="btn-test" id="test-groq" data-provider="groq">
            <span class="material-symbols-rounded">science</span>
            <span data-i18n="setup.testConnection">Test</span>
          </button>
          <div class="step-status" id="status-groq"></div>
        </div>
      </div>

      <!-- ===== Step 2: Serper ===== -->
      <div class="setup-step-panel" data-step="2" style="display:none;">
        <div class="step-header-row">
          <div class="step-icon-box serper-graphic">
            <span class="material-symbols-rounded">travel_explore</span>
          </div>
          <div class="step-header-text">
            <h4 data-i18n="setup.serper.title">Serper API key</h4>
            <p data-i18n="setup.serper.descriptionFull">Serper searches the web for evidence. Free plan: 2,500 searches.</p>
          </div>
        </div>

        <div class="step-how-to">
          <p class="step-how-to-label" data-i18n="setup.howTo">How to get your key:</p>
          <ol class="step-instructions-list">
            <li data-i18n="setup.instructions.serper.1">Open serper.dev/api-key</li>
            <li data-i18n="setup.instructions.serper.2">Create a free account</li>
            <li data-i18n="setup.instructions.serper.3">Copy the API key from dashboard</li>
          </ol>
        </div>

        <a class="btn-get-key" href="https://serper.dev/api-key" target="_blank" rel="noopener">
          <span class="material-symbols-rounded">open_in_new</span>
          <span data-i18n="setup.openSerperSite">Open Serper Dashboard</span>
          <span class="material-symbols-rounded btn-get-key-arrow">arrow_forward</span>
        </a>

        <div class="input-wrapper">
          <input id="input-serper" type="password" class="setup-input" autocomplete="off"
            data-i18n-placeholder="setup.placeholder.serper">
          <button class="visibility-toggle" data-target="input-serper" data-i18n-title="setup.toggleVisibility">
            <span class="material-symbols-rounded">visibility</span>
          </button>
        </div>
        <div class="step-input-actions">
          <button class="btn-test" id="test-serper" data-provider="serper">
            <span class="material-symbols-rounded">science</span>
            <span data-i18n="setup.testConnection">Test</span>
          </button>
          <div class="step-status" id="status-serper"></div>
        </div>
      </div>

      <!-- ===== Step 3: Gemini (Optional) ===== -->
      <div class="setup-step-panel" data-step="3" style="display:none;">
        <div class="step-header-row">
          <div class="step-icon-box gemini-graphic">
            <span class="material-symbols-rounded">auto_awesome</span>
          </div>
          <div class="step-header-text">
            <div class="step-optional-tag" data-i18n="setup.optional">Optional</div>
            <h4 data-i18n="setup.gemini.title">Gemini API key</h4>
            <p data-i18n="setup.gemini.descriptionFull">Backup AI. If Groq fails, Gemini takes over. You can skip this.</p>
          </div>
        </div>

        <div class="step-how-to">
          <p class="step-how-to-label" data-i18n="setup.howTo">How to get your key:</p>
          <ol class="step-instructions-list">
            <li data-i18n="setup.instructions.gemini.1">Open aistudio.google.com/app/apikey</li>
            <li data-i18n="setup.instructions.gemini.2">Create an API key and copy it</li>
            <li data-i18n="setup.instructions.gemini.3">Paste it below, or skip this step</li>
          </ol>
        </div>

        <a class="btn-get-key" href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener">
          <span class="material-symbols-rounded">open_in_new</span>
          <span data-i18n="setup.openGeminiSite">Open Google AI Studio</span>
          <span class="material-symbols-rounded btn-get-key-arrow">arrow_forward</span>
        </a>

        <div class="input-wrapper">
          <input id="input-gemini" type="password" class="setup-input" autocomplete="off"
            data-i18n-placeholder="setup.placeholder.gemini">
          <button class="visibility-toggle" data-target="input-gemini" data-i18n-title="setup.toggleVisibility">
            <span class="material-symbols-rounded">visibility</span>
          </button>
        </div>
        <div class="step-input-actions">
          <button class="btn-test" id="test-gemini" data-provider="gemini">
            <span class="material-symbols-rounded">science</span>
            <span data-i18n="setup.testConnection">Test</span>
          </button>
          <div class="step-status" id="status-gemini"></div>
        </div>
      </div>

      <!-- Navigation -->
      <div class="setup-nav">
        <button id="setupBackBtn" class="btn-nav btn-nav-back" style="visibility:hidden;">
          <span class="material-symbols-rounded">arrow_back</span>
          <span data-i18n="setup.back">Back</span>
        </button>
        <button id="setupSkipBtn" class="btn-nav btn-nav-skip" style="display:none;">
          <span data-i18n="setup.skip">Skip</span>
          <span class="material-symbols-rounded">skip_next</span>
        </button>
        <button id="setupNextBtn" class="btn-nav btn-nav-next">
          <span data-i18n="setup.next">Next</span>
          <span class="material-symbols-rounded">arrow_forward</span>
        </button>
      </div>

      <button id="saveSetupBtn" class="btn-search setup-save-btn" style="display:none;width:100%;">
        <span class="material-symbols-rounded">check_circle</span>
        <span data-i18n="setup.save">Save & start using</span>
      </button>

      <div class="setup-privacy">
        <span class="material-symbols-rounded">shield</span>
        <span data-i18n="setup.privacy">Your API keys never leave your device.</span>
      </div>
    </div>

    <!-- ===== TABS & CONTENT (hidden until setup done) ===== -->
    <div class="tabs">
      <button class="tab-btn active" data-tab="search">
        <span class="material-symbols-rounded">search</span>
        <span data-i18n="tab.search">Search</span>
      </button>
      <button class="tab-btn" data-tab="binder">
        <span class="material-symbols-rounded">folder</span>
        <span data-i18n="tab.binder">Binder</span>
      </button>
    </div>

    <div id="view-search" class="view-section active">
      <div class="controls">
        <div class="btn-group">
          <button id="searchBtn" class="btn-search">
            <span class="material-symbols-rounded">travel_explore</span>
            <span data-i18n="action.search">Search</span>
          </button>
          <button id="extractBtn" class="btn-primary">
            <span class="material-symbols-rounded">description</span>
            <span data-i18n="action.extract">Extract</span>
          </button>
        </div>
        <button id="copyBtn" class="btn-secondary" disabled>
          <span class="material-symbols-rounded">content_copy</span>
          <span data-i18n="action.copyAll">Copy all</span>
        </button>
      </div>
      <div id="status" class="status"></div>
      <div id="results" class="results">
        <div class="placeholder">
          <span class="material-symbols-rounded">library_books</span>
          <p data-i18n="placeholder.search">Find answers and save them to your binder.</p>
        </div>
      </div>
    </div>

    <div id="view-binder" class="view-section">
      <div class="binder-header">
        <div class="binder-header-left">
          <span class="material-symbols-rounded binder-header-icon">menu_book</span>
          <div>
            <h2 data-i18n="binder.title">My Study</h2>
            <p class="binder-subtitle" data-i18n="binder.subtitle">Saved questions for review</p>
          </div>
        </div>
        <button id="clearBinderBtn" class="action-btn" data-i18n-title="binder.clearAll">
          <span class="material-symbols-rounded">delete_sweep</span>
        </button>
      </div>
      <div id="binder-list" class="results">
        <div class="placeholder">
          <span class="material-symbols-rounded">folder_open</span>
          <p data-i18n-html="binder.placeholderHtml">Your binder is empty.<br>Save questions to review later.</p>
        </div>
      </div>
    </div>

    <footer>
      <p>
        <span class="material-symbols-rounded" style="font-size:16px;">smart_toy</span>
        <span data-i18n="footer.refined">AI-refined answers with source weighting</span>
      </p>
    </footer>
  </div>

  <script type="module" src="popup.js"></script>
</body>

</html>
