<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AnswerHunter</title>
  <link rel="stylesheet" href="popup.css">
</head>

<body>
  <!-- ===== ONBOARDING WIZARD (Complete Redesign) ===== -->
  <div id="onboarding-view" class="onboarding-view hidden">

    <!-- Animated Background Blobs -->
    <div class="ob-blob ob-blob-1"></div>
    <div class="ob-blob ob-blob-2"></div>
    <div class="ob-blob ob-blob-3"></div>

    <!-- Dot Grid Pattern -->
    <div class="ob-dot-grid"></div>

    <!-- Top Progress Indicator -->
    <div class="ob-progress-track">
      <div class="ob-progress-fill" id="onboarding-progress-bar"></div>
      <div class="ob-progress-glow" id="ob-progress-glow"></div>
    </div>

    <!-- Step Indicator Dots -->
    <div class="ob-step-dots" id="ob-step-dots">
      <button class="ob-dot active" data-step="0" title="Welcome"></button>
      <button class="ob-dot" data-step="1" title="Groq"></button>
      <button class="ob-dot" data-step="2" title="Serper"></button>
      <button class="ob-dot" data-step="3" title="Gemini"></button>
    </div>

    <!-- SLIDES WRAPPER -->
    <div class="ob-slides-viewport">
      <div class="ob-slides" id="onboarding-slides">

        <!-- ═══════════ SLIDE 0: WELCOME ═══════════ -->
        <div class="ob-slide" data-slide="0">
          <div class="ob-slide-inner ob-center">

            <!-- Animated Illustration -->
            <div class="ob-hero-illustration">
              <div class="ob-orbit-ring ob-orbit-1"></div>
              <div class="ob-orbit-ring ob-orbit-2"></div>
              <div class="ob-hero-icon-wrap">
                <span class="material-symbols-rounded ob-hero-icon">rocket_launch</span>
              </div>
              <div class="ob-orbit-dot ob-od-1"><span class="material-symbols-rounded">search</span></div>
              <div class="ob-orbit-dot ob-od-2"><span class="material-symbols-rounded">psychology</span></div>
              <div class="ob-orbit-dot ob-od-3"><span class="material-symbols-rounded">auto_awesome</span></div>
            </div>

            <h1 class="ob-title" data-i18n="setup.new.welcome.title">Welcome to AnswerHunter</h1>
            <p class="ob-subtitle" data-i18n="setup.new.welcome.desc">Your AI-powered study companion. Let's get you
              ready in less than 2 minutes.</p>

            <!-- Feature Pills -->
            <div class="ob-feature-pills">
              <div class="ob-pill">
                <span class="material-symbols-rounded">bolt</span>
                <span data-i18n="setup.feature.fast">Lightning Fast</span>
              </div>
              <div class="ob-pill">
                <span class="material-symbols-rounded">lock</span>
                <span data-i18n="setup.feature.private">100% Private</span>
              </div>
              <div class="ob-pill">
                <span class="material-symbols-rounded">money_off</span>
                <span data-i18n="setup.feature.free">Free APIs</span>
              </div>
            </div>

            <button id="welcomeStartBtn" class="ob-btn-hero">
              <span data-i18n="setup.new.start">Get Started</span>
              <span class="material-symbols-rounded">arrow_forward</span>
              <div class="ob-btn-hero-shine"></div>
            </button>

            <p class="ob-time-hint">
              <span class="material-symbols-rounded" style="font-size:14px;">schedule</span>
              <span data-i18n="setup.timeHint">Takes about 2 minutes</span>
            </p>
          </div>
        </div>

        <!-- ═══════════ SLIDE 1: GROQ ═══════════ -->
        <div class="ob-slide" data-slide="1">
          <div class="ob-slide-inner">

            <!-- Step Header -->
            <div class="ob-step-header">
              <div class="ob-step-num groq-accent">1</div>
              <div class="ob-step-info">
                <div class="ob-step-label">
                  <span data-i18n="setup.step">Step</span> 1/3
                  <span class="ob-required-tag" data-i18n="setup.required">Required</span>
                </div>
                <h2 data-i18n="setup.groq.title">Connect the Brain</h2>
              </div>
            </div>

            <p class="ob-step-desc" data-i18n="setup.groq.tagline">Groq powers the AI analysis. It's free and
              incredibly fast.</p>
            <div class="ob-begin-hint">
              <span class="material-symbols-rounded">touch_app</span>
              <span data-i18n="setup.beginHint">Start with button 1 below. After copying the key, come back and paste
                it here.</span>
            </div>

            <!-- Interactive Tutorial -->
            <div class="ob-tutorial-card expanded" id="tutorial-groq">
              <button class="ob-tutorial-toggle" type="button">
                <span class="material-symbols-rounded">school</span>
                <span data-i18n="setup.stepByStepGuide">Step-by-step guide</span>
                <span class="material-symbols-rounded ob-tutorial-caret">expand_more</span>
              </button>
              <div class="ob-tutorial-body">
                <div class="ob-tutorial-step" style="--delay:0s">
                  <div class="ob-ts-num groq-accent">1</div>
                  <div class="ob-ts-content">
                    <span data-i18n="setup.groq.step1">Click "Open official site" and create your free Groq account.</span>
                  </div>
                </div>
                <div class="ob-tutorial-step" style="--delay:0.1s">
                  <div class="ob-ts-num groq-accent">2</div>
                  <div class="ob-ts-content">
                    <span data-i18n="setup.groq.step2">On Groq, open "API Keys" and create a new key.</span>
                  </div>
                </div>
                <div class="ob-tutorial-step" style="--delay:0.2s">
                  <div class="ob-ts-num groq-accent">3</div>
                  <div class="ob-ts-content">
                    <span data-i18n="setup.groq.step3">Copy the key, paste below, then click "Validate key".</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Key Input Card -->
            <div class="ob-key-card">
              <label class="ob-key-label" for="input-groq">
                <span class="material-symbols-rounded">vpn_key</span>
                <span>API Key</span>
              </label>
              <div class="ob-input-wrap">
                <input type="password" id="input-groq" class="ob-input" placeholder="gsk_..." autocomplete="off">
                <button class="visibility-toggle" data-target="input-groq" type="button">
                  <span class="material-symbols-rounded">visibility</span>
                </button>
              </div>
              <div class="ob-input-hint" id="hint-groq">
                <span class="material-symbols-rounded">info</span>
                <span data-i18n="setup.hint.groq">Starts with "gsk_"</span>
              </div>
            </div>

            <!-- Action Buttons Row -->
            <div class="ob-actions-row">
              <a href="https://console.groq.com/keys" target="_blank" rel="noopener noreferrer"
                class="ob-btn-link groq-link">
                <span class="material-symbols-rounded">open_in_new</span>
                <span data-i18n="setup.openSiteAction">1. Open official site</span>
                <span class="ob-free-chip">FREE</span>
              </a>
              <button id="test-groq" class="ob-btn-test" data-provider="groq" type="button">
                <span class="material-symbols-rounded">wifi_tethering</span>
                <span data-i18n="setup.validateAction">2. Validate key</span>
              </button>
            </div>

            <div class="ob-test-status" id="status-groq"></div>
            <p class="ob-next-help" data-i18n="setup.nextHelp">When validation is successful, the Next button unlocks
              automatically.</p>

            <!-- Footer Navigation -->
            <div class="ob-nav-footer">
              <button class="ob-nav-back" id="prev-groq" type="button">
                <span class="material-symbols-rounded">arrow_back</span>
              </button>
              <div class="ob-nav-spacer"></div>
              <button class="ob-nav-next" id="btn-next-groq" disabled type="button">
                <span data-i18n="setup.next">Next</span>
                <span class="material-symbols-rounded">arrow_forward</span>
              </button>
            </div>
          </div>
        </div>

        <!-- ═══════════ SLIDE 2: SERPER ═══════════ -->
        <div class="ob-slide" data-slide="2">
          <div class="ob-slide-inner">

            <div class="ob-step-header">
              <div class="ob-step-num serper-accent">2</div>
              <div class="ob-step-info">
                <div class="ob-step-label">
                  <span data-i18n="setup.step">Step</span> 2/3
                  <span class="ob-required-tag" data-i18n="setup.required">Required</span>
                </div>
                <h2 data-i18n="setup.serper.title">Enable Vision</h2>
              </div>
            </div>

            <p class="ob-step-desc" data-i18n="setup.serper.tagline">Serper allows the AI to search the web for
              evidence.</p>

            <div class="ob-tutorial-card" id="tutorial-serper">
              <button class="ob-tutorial-toggle" type="button">
                <span class="material-symbols-rounded">school</span>
                <span data-i18n="setup.howToGetKey">How to get your key</span>
                <span class="material-symbols-rounded ob-tutorial-caret">expand_more</span>
              </button>
              <div class="ob-tutorial-body" hidden>
                <div class="ob-tutorial-step" style="--delay:0s">
                  <div class="ob-ts-num serper-accent">1</div>
                  <div class="ob-ts-content">
                    <span data-i18n="setup.serper.step1">Go to <a href="https://serper.dev"
                        target="_blank">serper.dev</a> and sign up for free</span>
                  </div>
                </div>
                <div class="ob-tutorial-step" style="--delay:0.1s">
                  <div class="ob-ts-num serper-accent">2</div>
                  <div class="ob-ts-content">
                    <span data-i18n="setup.serper.step2">Open your Dashboard</span>
                  </div>
                </div>
                <div class="ob-tutorial-step" style="--delay:0.2s">
                  <div class="ob-ts-num serper-accent">3</div>
                  <div class="ob-ts-content">
                    <span data-i18n="setup.serper.step3">Copy the API Key from the main page</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="ob-key-card">
              <label class="ob-key-label" for="input-serper">
                <span class="material-symbols-rounded">travel_explore</span>
                <span>API Key</span>
              </label>
              <div class="ob-input-wrap">
                <input type="password" id="input-serper" class="ob-input" placeholder="Your Serper Key..."
                  autocomplete="off">
                <button class="visibility-toggle" data-target="input-serper" type="button">
                  <span class="material-symbols-rounded">visibility</span>
                </button>
              </div>
              <div class="ob-input-hint" id="hint-serper">
                <span class="material-symbols-rounded">info</span>
                <span data-i18n="setup.hint.serper">From serper.dev dashboard</span>
              </div>
            </div>

            <div class="ob-actions-row">
              <a href="https://serper.dev/api-key" target="_blank" class="ob-btn-link serper-link">
                <span class="material-symbols-rounded">open_in_new</span>
                <span data-i18n="setup.getKey">Get Free Key</span>
                <span class="ob-free-chip">FREE</span>
              </a>
              <button id="test-serper" class="ob-btn-test" data-provider="serper" type="button">
                <span class="material-symbols-rounded">wifi_tethering</span>
                <span data-i18n="setup.test">Test Key</span>
              </button>
            </div>

            <div class="ob-test-status" id="status-serper"></div>

            <div class="ob-nav-footer">
              <button class="ob-nav-back" id="prev-serper" type="button">
                <span class="material-symbols-rounded">arrow_back</span>
              </button>
              <div class="ob-nav-spacer"></div>
              <button class="ob-nav-next" id="btn-next-serper" disabled type="button">
                <span data-i18n="setup.next">Next</span>
                <span class="material-symbols-rounded">arrow_forward</span>
              </button>
            </div>
          </div>
        </div>

        <!-- ═══════════ SLIDE 3: GEMINI (Optional) ═══════════ -->
        <div class="ob-slide" data-slide="3">
          <div class="ob-slide-inner">

            <div class="ob-step-header">
              <div class="ob-step-num gemini-accent">3</div>
              <div class="ob-step-info">
                <div class="ob-step-label">
                  <span data-i18n="setup.step">Step</span> 3/3
                  <span class="ob-optional-tag" data-i18n="setup.optional">Optional</span>
                </div>
                <h2 data-i18n="setup.gemini.title">Add Backup Power</h2>
              </div>
            </div>

            <p class="ob-step-desc" data-i18n="setup.gemini.tagline">Gemini acts as a fallback if Groq is busy.</p>

            <!-- Info Banner -->
            <div class="ob-info-banner">
              <span class="material-symbols-rounded">lightbulb</span>
              <span data-i18n="setup.gemini.hint">You can skip this step. Gemini only activates when Groq is
                unavailable.</span>
            </div>

            <div class="ob-tutorial-card" id="tutorial-gemini">
              <button class="ob-tutorial-toggle" type="button">
                <span class="material-symbols-rounded">school</span>
                <span data-i18n="setup.howToGetKey">How to get your key</span>
                <span class="material-symbols-rounded ob-tutorial-caret">expand_more</span>
              </button>
              <div class="ob-tutorial-body" hidden>
                <div class="ob-tutorial-step" style="--delay:0s">
                  <div class="ob-ts-num gemini-accent">1</div>
                  <div class="ob-ts-content">
                    <span data-i18n="setup.gemini.step1">Go to <a href="https://aistudio.google.com"
                        target="_blank">aistudio.google.com</a></span>
                  </div>
                </div>
                <div class="ob-tutorial-step" style="--delay:0.1s">
                  <div class="ob-ts-num gemini-accent">2</div>
                  <div class="ob-ts-content">
                    <span data-i18n="setup.gemini.step2">Click "Get API Key" → "Create API Key"</span>
                  </div>
                </div>
                <div class="ob-tutorial-step" style="--delay:0.2s">
                  <div class="ob-ts-num gemini-accent">3</div>
                  <div class="ob-ts-content">
                    <span data-i18n="setup.gemini.step3">Copy the key that starts with "AIza"</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="ob-key-card">
              <label class="ob-key-label" for="input-gemini">
                <span class="material-symbols-rounded">auto_awesome</span>
                <span>API Key</span>
              </label>
              <div class="ob-input-wrap">
                <input type="password" id="input-gemini" class="ob-input" placeholder="AIza..." autocomplete="off">
                <button class="visibility-toggle" data-target="input-gemini" type="button">
                  <span class="material-symbols-rounded">visibility</span>
                </button>
              </div>
              <div class="ob-input-hint" id="hint-gemini">
                <span class="material-symbols-rounded">info</span>
                <span data-i18n="setup.hint.gemini">Starts with "AIza"</span>
              </div>
            </div>

            <div class="ob-actions-row">
              <a href="https://aistudio.google.com/app/apikey" target="_blank" class="ob-btn-link gemini-link">
                <span class="material-symbols-rounded">open_in_new</span>
                <span data-i18n="setup.getKey">Get Free Key</span>
                <span class="ob-free-chip">FREE</span>
              </a>
              <button id="test-gemini" class="ob-btn-test" data-provider="gemini" type="button">
                <span class="material-symbols-rounded">wifi_tethering</span>
                <span data-i18n="setup.test">Test Key</span>
              </button>
            </div>

            <div class="ob-test-status" id="status-gemini"></div>

            <div class="ob-nav-footer">
              <button class="ob-nav-back" id="prev-gemini" type="button">
                <span class="material-symbols-rounded">arrow_back</span>
              </button>
              <div class="ob-nav-spacer"></div>
              <button class="ob-btn-finish" id="saveSetupBtn" type="button">
                <span class="material-symbols-rounded">check_circle</span>
                <span data-i18n="setup.finish">Finish Setup</span>
              </button>
            </div>

            <button id="setupSkipBtn" class="ob-btn-skip" type="button">
              <span data-i18n="setup.skipGemini">Skip Gemini, finish setup</span>
            </button>
          </div>
        </div>

      </div>
    </div>

    <!-- Privacy Footer -->
    <div class="ob-privacy-bar">
      <span class="material-symbols-rounded">shield</span>
      <span data-i18n="setup.privacy">Your keys are stored locally and never sent to our servers.</span>
    </div>
  </div>

  <!-- ===== TOAST CONTAINER ===== -->
  <div id="toast-container" class="toast-container" aria-live="polite"></div>

  <!-- ===== MAIN CONTAINER (Hidden during onboarding) ===== -->
  <div class="container" id="main-app-container">
    <header>
      <div class="header-top">
        <div class="header-brand">
          <span class="material-symbols-rounded header-logo">track_changes</span>
          <div>
            <h1 data-i18n="app.title">AnswerHunter</h1>
            <p class="subtitle" data-i18n="app.subtitle">Educational answer hunter</p>
          </div>
        </div>
        <div class="header-actions">
          <div class="lang-toggle" id="languageToggle">
            <button type="button" class="lang-btn active" data-lang="en">
              <svg viewBox="0 0 640 480" class="lang-flag">
                <path fill="#bd3d44"
                  d="M0 0h640v37h-640zm0 73.9h640v37h-640zm0 73.8h640v37h-640zm0 73.8h640v37h-640zm0 73.9h640v37h-640zm0 73.8h640v37h-640zm0 73.8h640v36.9h-640z" />
                <path fill="#fff"
                  d="M0 37h640v36.9h-640zm0 73.8h640v36.9h-640zm0 73.9h640v36.8h-640zm0 73.8h640v37h-640zm0 73.9h640v36.8h-640zm0 73.8h640v36.9h-640z" />
                <path fill="#192f5d" d="M0 0h256v258.5h-256z" />
                <g fill="#fff">
                  <g id="s18">
                    <g id="s9">
                      <g id="s5">
                        <g id="s4">
                          <path id="s"
                            d="M26.2 17l3.5 10.8h11.4l-9.2 6.7 3.5 10.8-9.2-6.7-9.2 6.7 3.5-10.8-9.2-6.7h11.4z" />
                          <use href="#s" x="52.4" />
                        </g>
                        <use href="#s4" x="104.8" />
                      </g>
                      <use href="#s4" x="157.2" />
                    </g>
                    <use href="#s5" y="39.4" />
                  </g>
                  <use href="#s9" y="78.8" />
                </g>
                <use href="#s18" x="26.2" y="19.7" />
                </g>
              </svg>
              EN
            </button>
            <button type="button" class="lang-btn" data-lang="pt-BR">
              <svg viewBox="0 0 640 480" class="lang-flag">
                <path fill="#229e45" d="M0 0h640v480H0z" />
                <path fill="#f8e509" d="M321.4 36.2 609.7 240 321.4 443.8 33.1 240z" />
                <circle fill="#2b49a3" cx="321.4" cy="240" r="113.4" />
                <path fill="#fff" d="M195.8 231.5c37.6-58.1 109.8-82.2 169-59a116 116 0 0 0-169 59z" />
              </svg>
              PT
            </button>
          </div>
          <button id="settingsBtn" class="settings-btn" data-i18n-title="app.settings">
            <span class="material-symbols-rounded">settings</span>
          </button>
        </div>
      </div>
    </header>

    <!-- ===== TABS & CONTENT (hidden until setup done) ===== -->
    <div class="tabs">
      <button class="tab-btn active" data-tab="search">
        <span class="material-symbols-rounded">search</span>
        <span data-i18n="tab.search">Search</span>
      </button>
      <button class="tab-btn" data-tab="binder">
        <span class="material-symbols-rounded">folder</span>
        <span data-i18n="tab.binder">Binder</span>
      </button>
    </div>

    <div id="view-search" class="view-section active">
      <div class="controls">
        <div class="btn-group">
          <button id="searchBtn" class="btn-search">
            <span class="material-symbols-rounded">travel_explore</span>
            <span data-i18n="action.search">Search</span>
          </button>
          <button id="extractBtn" class="btn-primary">
            <span class="material-symbols-rounded">description</span>
            <span data-i18n="action.extract">Extract</span>
          </button>
        </div>
        <button id="copyBtn" class="btn-secondary" disabled>
          <span class="material-symbols-rounded">content_copy</span>
          <span data-i18n="action.copyAll">Copy all</span>
        </button>
      </div>
      <div id="status" class="status"></div>
      <div id="results" class="results">
        <div class="placeholder">
          <span class="material-symbols-rounded">library_books</span>
          <p data-i18n="placeholder.search">Find answers and save them to your binder.</p>
        </div>
      </div>
    </div>

    <div id="view-binder" class="view-section">
      <div class="binder-header">
        <div class="binder-header-left">
          <span class="material-symbols-rounded binder-header-icon">menu_book</span>
          <div>
            <h2 data-i18n="binder.title">My Study</h2>
            <p class="binder-subtitle" data-i18n="binder.subtitle">Saved questions for review</p>
          </div>
        </div>
        <button id="clearBinderBtn" class="action-btn" data-i18n-title="binder.clearAll">
          <span class="material-symbols-rounded">delete_sweep</span>
        </button>
      </div>
      <div id="binder-list" class="results">
        <div class="placeholder">
          <span class="material-symbols-rounded">folder_open</span>
          <p data-i18n-html="binder.placeholderHtml">Your binder is empty.<br>Save questions to review later.</p>
        </div>
      </div>
    </div>

    <footer>
      <p>
        <span class="material-symbols-rounded" style="font-size:16px;">smart_toy</span>
        <span data-i18n="footer.refined">AI-refined answers with source weighting</span>
      </p>
    </footer>
  </div>

  <script type="module" src="popup.js"></script>
</body>

</html>
